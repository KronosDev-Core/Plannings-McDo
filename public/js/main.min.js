const DATA={DayWeekDate:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],DayWeekDataTable:[9,3,4,5,6,7,8],Role:{LST:"Service à table",LCA:"Chargé d'acceuil",LN:"Néttoyage lobby",CPE:"Passage éxterieur",CBL:"Boisson lobby",CBD:"Boisson drive",CG:"Glace",CPB:"Passage boisson",CVL:"Vérif lobby",CVD:"Vérif Drive",CEL:"Encaissement lobby",CED:"Encaissement drive",CRC:"Rappel Commande",CTD:"Tablette drive",CTL:"Tablette lobby",COL:"OAT lobby",COD:"OAT drive",CO:"OAT",CF:"Frite",CRZ:"RZ Comptoir",KRZ:"RZ Cuisine",KP:"Pain",KG:"Garniture",KU:"UHC",KDU:"Double UHC",KCF:"Cuisson frit",KCV:"Cuisson viande",KCD:"Double cuisson",CK:"Close Cuisine",CL:"Close Lobby",CC:"Close Plonge"},Pays:{IM:"Île de Man",HR:"Croatie",GW:"Guinée-Bissau",IN:"Inde",KE:"Kenya",LA:"Laos",IO:"Territoire britannique de l'océan Indien",HT:"Haïti",LB:"Liban",GY:"Guyana",KG:"Kirghizistan",HU:"Hongrie",LC:"Sainte-Lucie",IQ:"Irak",KH:"Cambodge",JM:"Jamaïque",IR:"Iran",KI:"Kiribati",IS:"Islande",MA:"Maroc",JO:"Jordanie",IT:"Italie",JP:"Japon",MC:"Monaco",KM:"Comores",MD:"Moldavie",LI:"Liechtenstein",KN:"Saint-Christophe-et-Niévès",ME:"Monténégro",NA:"Namibie",MF:"Saint-Martin",LK:"Sri Lanka",KP:"Corée du Nord",MG:"Madagascar",NC:"Nouvelle-Calédonie",MH:"Îles Marshall",KR:"Corée du Sud",NE:"Niger",NF:"Île Norfolk",MK:"Macédoine",NG:"Nigéria",ML:"Mali",MM:"Myanmar (Birmanie)",LR:"Libéria",NI:"Nicaragua",KW:"Koweït",MN:"Mongolie",LS:"Lesotho",PA:"Panamá",MO:"Macau",LT:"Lituanie",KY:"Îles Caïmans",MP:"Îles Mariannes du Nord",LU:"Luxembourg",NL:"Pays-Bas",KZ:"Kazakhstan",MQ:"Martinique",LV:"Lettonie",MR:"Mauritanie",PE:"Pérou",MS:"Montserrat",QA:"Qatar",NO:"Norvège",PF:"Tahïti (Polynésie française)",MT:"Malte",LY:"Libye",NP:"Népal",PG:"Papouasie-Nouvelle-Guinée",MU:"Maurice",PH:"Philippines",MV:"Maldives",OM:"Oman",NR:"Nauru",MW:"Malawi",MX:"Mexico",PK:"Pakistan",MY:"Malaisie",NU:"Niue",PL:"Pologne",MZ:"Mozambique",PM:"Saint-Pierre-et-Miquelon",PN:"Îles Pitcairn",RE:"La Réunion",SA:"Arabie saoudite",SB:"Îles Salomon",NZ:"Nouvelle-Zélande",SC:"Seychelles",SD:"Soudan",PR:"Porto Rico",SE:"Suède",PS:"Territoires palestiniens occupés",PT:"Portugal",SG:"Singapour",TC:"Îles Turques-et-Caïques",SH:"Sainte-Hélène",TD:"Tchad",SI:"Slovénie",PW:"Palaos",SJ:"Svalbard et Jan Mayen",UA:"Ukraine",RO:"Roumanie",TF:"Terres australes et antarctiques françaises",SK:"Slovaquie",PY:"Paraguay",TG:"Togo",SL:"Sierra Leone",TH:"Thaïlande",SM:"Saint-Marin",SN:"Sénégal",RS:"Serbie (Yougoslavie)",TJ:"Tadjikistan",VA:"Cité du Vatican",SO:"Somalie",TK:"Tokelau",UG:"Ouganda",RU:"Russie",TL:"Timor oriental",VC:"Saint-Vincent-et-les-Grenadines",TM:"Turkménistan",SR:"Suriname",RW:"Rwanda",TN:"Tunisie",VE:"Venezuela",TO:"Tonga",ST:"Sao Tomé-et-Principe",VG:"Îles Vierges britanniques",SV:"Salvador",UM:"Îles mineures éloignées des États-Unis",TR:"Turquie",VI:"Îles Vierges(US)",WF:"Wallis-et-Futuna",TT:"Trinité-et-Tobago",SY:"Syrie",SZ:"Swaziland",TV:"Tuvalu",TW:"Taïwan",VN:"Viêt Nam",US:"États-Unis(USA)",TZ:"Tanzanie",YE:"Yémen",ZA:"Afrique du Sud",XK:"République du Kosovo",UY:"Uruguay",VU:"Vanuatu",UZ:"Ouzbékistan",WS:"Samoa",ZM:"Zambie",AC:"Île de l'Ascension",AD:"Andorre",YT:"Mayotte",AE:"Émirats arabes unis",YU:"Serbia and Montenegro",BA:"Serbie-et-Monténégro",AF:"Afghanistan",BB:"Barbade",AG:"Antigua-et-Barbuda",BD:"Bangladesh",AI:"Anguilla",BE:"Belgique",CA:"Canada",BF:"Burkina Faso",BG:"Bulgarie",ZW:"Zimbabwe",AL:"Albanie",CC:"Îles Cocos",BH:"Bahreïn",AM:"Arménie",CD:"République démocratique du Congo",BI:"Burundi",AN:"Antilles néerlandaises",BJ:"Bénin",AO:"Angola",CF:"République centrafricaine",CG:"République du Congo",AQ:"Antarctique",CH:"Suisse",BM:"Bermudes",AR:"Argentine",CI:"Côte d'Ivoire",BN:"Brunei Darussalam",DE:"Allemagne",AS:"Samoa américaines",BO:"Bolivie",AT:"Autriche",CK:"Îles Cook",AU:"Australie",CL:"Chili",EC:"Équateur",CM:"Cameroun",BR:"Brésil",AW:"Aruba",CN:"Chine",EE:"Estonie",BS:"Bahamas",DJ:"Djibouti",AX:"Åland",CO:"Colombie",BT:"Bhoutan",DK:"Danemark",EG:"Égypte",AZ:"Azerbaïdjan",EH:"Sahara occidental",BV:"Île Bouvet",DM:"Dominique",CR:"Costa Rica",BW:"Botswana",GA:"Gabon",DO:"République dominicaine",BY:"Biélorussie",GB:"Royaume-Uni",CU:"Cuba",BZ:"Bélize",CV:"Cap-Vert",GD:"Grenade",FI:"Finlande",GE:"Géorgie",FJ:"Fidji",CX:"Île Christmas",GF:"Guyane",FK:"Îles Malouines",CY:"Chypre",GG:"Guernesey",CZ:"République tchèque",GH:"Ghana",FM:"Micronésie",ER:"Érythrée",GI:"Gibraltar",ES:"Espagne",FO:"Îles Féroé",ET:"Éthiopie",GL:"Groenland",DZ:"Algérie",GM:"Gambie",ID:"Indonésie",FR:"France",GN:"Guinée",IE:"Irlande",HK:"Hong Kong",GP:"Guadeloupe",GQ:"Guinée équatoriale",HM:"Îles Heard-et-MacDonald",GR:"Grèce",HN:"Honduras",JE:"Jersey",GS:"Géorgie du Sud-et-les Îles Sandwich du Sud",FX:"France métropolitaine",GT:"Guatemala",GU:"Guam",IL:"Israël"},ErrorValidationForm:"Ce Champ doit être rempli !"};
const HREF={DivFormCardFooter:"body > div.my-3.h-100.w-100.container-fluid > div > div.col-auto > div > div.card-footer",ListUniqueWorkerButton:"div.card-body > ul li button",AnimationArrow:"RotateArrow",RowTableCard:"body > div.my-3.h-100.w-100.container-fluid > div > div.col-auto > div > div.card-body.table-responsive > table > tbody tr",ListUniqueWorkerHeader:"body > div.my-3.h-100.w-100.container-fluid > div > div.col > div > div.card-header > div > h5",InputSelectEmployee:"body > div.my-3.h-100.w-100.container-fluid > div > div.col-auto > div > div.card-footer > div.row.m-1 > div > select",InputSelectEmployeeOption:"body > div.my-3.h-100.w-100.container-fluid > div > div.col-auto > div > div.card-footer > div.row.m-1 > div > select option",InputSelectOption:"#OptionAdmin > div.row.m-1 > div > select",InputSelectOptionOption:"#OptionAdmin > div.row.m-1 > div > select option",InputSelectSubOption:"div#SubOptionAdmin > div.row.m-1 > div > select",InputSelectSubOptionOption:"div#SubOptionAdmin > div.row.m-1 > div > select option",DivNextAdminForm:"div#NextAdmin",DivAdminOption:"#OptionAdmin",DivAdminSubOption:"div#SubOptionAdmin",InputFormID:"#NextAdmin > form > div:nth-child(3) > div > input",InputFormDate:"#NextAdmin > form > div:nth-child(4) > div > input:nth-child(2)",InputFormStartWeek:"div#NextAdmin > form > input:nth-child(1)",InputFormTimeStart:"#NextAdmin > form > div:nth-child(4) > div > input:nth-child(5)",InputFormTimeEnd:"#NextAdmin > form > div:nth-child(4) > div > input:nth-child(8)",InputFormCheckAbsent:"#NextAdmin > form > div:nth-child(3) > div > div.form-control > input",InputFormFullName:"#NextAdmin > form > div:nth-child(3) > div > input",TitleTableCard:"body > div.my-3.h-100.w-100.container-fluid > div > div.col-auto > div > div.card-header > div > h5",ButtonFormCardFooter:"div#NextAdmin > form > div.row.m-1.justify-content-md-center > div > button.btn.btn-outline-success",ButtonDeleteForm:"div#NextAdmin > form > div.row.m-1.justify-content-md-center > div > button.btn.btn-outline-danger",BodyTable:"body > div.my-3.h-100.w-100.container-fluid > div > div.col-auto > div > div.card-body.table-responsive > table > tbody",TableSpecificLine:i=>void 0!==i.column?`body > div.my-3.h-100.w-100.container-fluid > div > div.col-auto > div > div.card-body.table-responsive > table > tbody > tr:nth-child(${i.row}) > td:nth-child(${i.column})`:`body > div.my-3.h-100.w-100.container-fluid > div > div.col-auto > div > div.card-body.table-responsive > table > tbody > tr:nth-child(${i.row})`,CardSpecificDay:i=>`#collapse${i}`,SelectSpecificEmployee:i=>`body > div.my-3.h-100.w-100.container-fluid > div > div.col-auto.mb-3 > div > div.card-footer > div.row.m-1 > div > select > option[value='${i}']`,SelectSpecificOptionEmploye:i=>`body > div.my-3.h-100.w-100.container-fluid > div > div.col-auto.mb-3 > div > div.card-footer > div.row.m-1 > div > select > option:nth-child(${i})`,SelectSpecificOption:i=>`#OptionAdmin > div.row.m-1 > div > select > option[value='${i}']`,SelectSpecificSubOption:i=>`div#SubOptionAdmin > div.row.m-1 > div > select > option[value='${i}']`,SelectTimeWeek:"body > div.my-3.h-100.w-100.container-fluid > div > div.col-auto.mb-3 > div > div.card-header > div > select",SelectTimeWeekAllOption:"body > div.my-3.h-100.w-100.container-fluid > div > div.col-auto.mb-3 > div > div.card-header > div > select option",SelectTimeWeekOption:i=>`body > div.my-3.h-100.w-100.container-fluid > div > div.col-auto.mb-3 > div > div.card-header > div > select > option:nth-child(${i+1})`,SpecificColumnTable:i=>`body > div.my-3.h-100.w-100.container-fluid > div > div.col-auto.mb-3 > div > div.card-body.table-responsive > table * > tr *:nth-child(${i})`,SpecificDropDownCard:i=>`body > div.my-3.h-100.w-100.container-fluid > div > div.col > div > div.card-body > ul > li > button > div[value="${i}"]`,AllPTextWarning:"body > div.my-3.h-100.w-100.container-fluid > div > div.col-auto.mb-3 > div > div.card-body.table-responsive > table > tbody > tr td p.text-warning",PTotalEmpWork:"p#TotalEmpWork",BtnOptionEmploye:"#BtnOptionEmploye",DivOptionEmploye:"#OptionEmploye",BtnSalaireEmploye:"#OptionEmploye > button.btn.btn-outline-warning.border-0",BtnRoleEmploye:"#OptionEmploye > button.btn.btn-outline-info.border-0",RoleEmployeeWorkTimeDiv:"#NextAdmin > form > div:nth-child(6) > div",InputSelectRole:"#NextAdmin > form > div:nth-child(6) > div > select",BtnSearchBar:"body > div.sticky-top > nav > div > div.d-flex > button.btn.LogoMcDo.me-4",InputSearchBar:"body > div.sticky-top > nav > div > div.d-flex > input",InputLineWork:"#NextAdmin > form > div:nth-child(6) > div > input",MainPageBtn:"body > div > div:nth-child(2) > div.d-flex.flex-row.align-content-between.m-auto.my-2 button",MainPageDivBtn:"body > div > div:nth-child(2) > div.d-flex.flex-row.align-content-between.m-auto.my-2",DivMainPageForm:"body > div > div:nth-child(2)",SelectMainPage:"body > div > div:nth-child(2) div div select",SelectDepartement:"body > div > div:nth-child(2) > div:nth-child(2) > div > select",divSpecificMainPage:i=>`body > div > div:nth-child(2) > div:nth-child(${i})`,SelectSpecificMainPage:i=>`body > div > div:nth-child(2) > div:nth-child(${i}) > div > select`,DivConnectionLandingPage:"#DivConnection",BtnConnectionLandingPage:"#DivConnection > div:nth-child(3) > button",IptUsername:"#DivConnection > div:nth-child(1) > div > input",IptPassword:"#DivConnection > div:nth-child(2) > div > input",DivConnectPlannings:"body > div.sticky-top > nav > div > div.d-flex > div > button:nth-child(1)"};
function getFormatInputTime(e){var t=e.split(":")[0],r=e.split(":")[1],e="";return 1==t.length?e+=`0${t}`:e+=t,e+=":",1==r.length?e+=`0${r}`:e+=r,e}function ToFormatInputTime(e){return`${e.substring(0,2)}:${e.substring(2,4)}`}function ToFormatCardFromTable(e){return e.replaceAll(/(<p class="Time-.*">|<p>)/gm,"").replaceAll("</p>","").replaceAll("<div>","").replaceAll("</div>","").replaceAll('<hr class="dropdown-divider">'," ; ").replaceAll(/\n/gm,"").replaceAll("                    ","").replaceAll(/^ /gm,"")}function GetDataTable(e,t,r,a,n,i,o,l,u,p,s){return{FullName:s.children[1].innerHTML,id:s.children[0].innerHTML,HourMonday:ToFormatCardFromTable(s.children[2].innerHTML),HourTuesday:ToFormatCardFromTable(s.children[3].innerHTML),HourWednesday:ToFormatCardFromTable(s.children[4].innerHTML),HourThursday:ToFormatCardFromTable(s.children[5].innerHTML),HourFriday:ToFormatCardFromTable(s.children[6].innerHTML),HourSaturday:ToFormatCardFromTable(s.children[7].innerHTML),HourSunday:ToFormatCardFromTable(s.children[8].innerHTML),TotalHour:s.children[9].innerHTML.split(" ")[0]}}function getRangeWeek(e){var t,r;return r=0!=(t=null!=e?new Date(e):new Date((new Date).toDateString())).getDay()?t.getDate()-t.getDay()+1:t.getDate()-6,e=0!=t.getDay()?r+6:t.getDate(),[new Date(t.setDate(r)),new Date(t.setDate(e)),new Date(t.setDate(r)).getTime()]}function FormatCompactDate(e,t="day"){return"day"==t?9<e.getDate()?e.getDate():"0"+e.getDate():9<e.getMonth()?e.getMonth()+1:"0"+(e.getMonth()+1)}function SimulateEvent(e,t="change"){if(!e)return new Error("element n'est pas définie");if("createEvent"in document){var r=document.createEvent("HTMLEvents");return r.initEvent(t,!1,!0),e.dispatchEvent(r),r}}function TimeBetweenTwoTime(e,t){e=e.split(":"),t=t.split(":");var r=new Date;return"00"==t[0]&&r.setDate(r.getDate()+1),Number(Number(new Date(r.setHours(t[0],t[1],0,0)-(new Date).setHours(e[0],e[1],0,0)))/36e5).round()}function ReloadTooltips(){[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')).map(function(e){return new bootstrap.Tooltip(e,{sanitize:!1})})}function TimeWorkCurrent(e,t,r=null,a=!1){if(e){var n="",i=!1,o=!1;p=0==a?(u=(l=r.split(" - "))[0].split(":"),l[1].split(":")):(u=t.StartHour.split("."),t.EndHour.split("."));var e=Number(u[0]),a=Number(u[1]),r=Number(p[0]),l=Number(p[1]),u=(new Date).getHours(),p=(new Date).getMinutes();return r<5&&(r+=23),5<=r-e&&a<=l&&(n='<i class="bi bi-exclamation-circle-fill text-warning me-2"></i>'),t.DayDate===`${(new Date).setFullTime(2,0,0,0)}`?(i=!0,e<u&&u<r||u==e&&a<=p||u==r&&!(l<p)?(Work="text-warning",o=!0):Work=r<u||r==u&&l<=p?"text-success":"text-danger"):Work=new Date(Number(t.DayDate)).getDay()<(new Date).getDay()||0===(new Date).getDay()&&0!=new Date(Number(t.DayDate)).getDay()?"text-success":"text-danger",[Work,n,i,o]}}function SpecificDay(e,t,r=null,a=null){var n,i;Number(e.split(":")[0])<15?Number(e.split(":")[0])<10&&Number(e.split("-")[1].split(":")[0])<12?kronos(HREF.CardSpecificDay(DATA.DayWeekDate[t])).append(HTML.TemplateLineCard({type:"chill",time:e,open:!0})):kronos(HREF.CardSpecificDay(DATA.DayWeekDate[t])).append(HTML.TemplateLineCard({type:"moderate",time:e})):18<=Number(e.split(":")[0])?Number(e.split("-")[1].split(":")[0])<5||23===Number(e.split("-")[1].split(":")[0])&&0<Number(e.split("-")[1].split(":")[1])?0===t||5<=t?kronos(HREF.CardSpecificDay(DATA.DayWeekDate[t])).append(HTML.TemplateLineCard({type:"moderate",time:e,close:!0})):kronos(HREF.CardSpecificDay(DATA.DayWeekDate[t])).append(HTML.TemplateLineCard({type:"chill",time:e,close:!0})):kronos(HREF.CardSpecificDay(DATA.DayWeekDate[t])).append(HTML.TemplateLineCard({type:"danger",time:e})):kronos(HREF.CardSpecificDay(DATA.DayWeekDate[t])).append(HTML.TemplateLineCard({type:"chill",time:e})),null!==a&&null!==r&&a.split(";").length!==r+1&&(n=e,i=a.split(";")[r+1],[a,r]=n.split("-")[1].split(":"),[n,i]=i.split("-")[0].split(":"),(Number(n)-Number(a)==0&&Number(i)-Number(r)==30||Number(n)-Number(a)==1&&Number(i)-Number(r)==-30)&&kronos(HREF.CardSpecificDay(DATA.DayWeekDate[t])).append(HTML.TemplateLineCard({type:"pause",time:e})))}function Search(r,a){var n=kronos(HREF.InputSearchBar).value();""!==n&&(isNaN(Number(n))?void 0!==a[n]?1!==Object.keys(a).indexOf(n)&&kronos(HREF.TableSpecificLine({row:r[a[n]]++}))[0].scrollIntoView(!0):Object.keys(a).forEach((e,t)=>{elemif=e.toLowerCase(),n=String(n).toLowerCase(),elemif.includes(n)&&kronos(HREF.TableSpecificLine({row:r[a[e]]++}))[0].scrollIntoView(!0)}):kronos(HREF.TableSpecificLine({row:r[Number(n)]++}))[0].scrollIntoView(!0))}Date.prototype.FormatYMD=function(){var e=new Date(this.valueOf()),t=`${e.getFullYear()}`;return 1==String(e.getMonth()+1).length?t+=`-0${e.getMonth()+1}`:t+=`-${e.getMonth()+1}`,1==String(e.getDate()).length?t+=`-0${e.getDate()}`:t+=`-${e.getDate()}`,t},Date.prototype.FormatDM=function(){var e=new Date(this.valueOf()),t="";return 1==String(e.getDate()).length?t+=`0${e.getDate()}`:t+=`${e.getDate()}`,1==String(e.getMonth()+1).length?t+=`/0${e.getMonth()+1}`:t+=`/${e.getMonth()+1}`,t},Date.prototype.setFullTime=function(e=0,t=0,r=0,a=0){return new Date(this.valueOf()).setHours(e,t,r,a)},Number.prototype.round=function(){return Math.round(100*(this+Number.EPSILON))/100},Array.prototype.last=function(){return this[this.length-1]};
const HTML={SelectOptionEmployee:e=>`<option value="${e._id}">${e.id} | ${e.name} | ${String(e.MaxHour).replace(".",",")}h/sem</option>`,SelectOptionTimeWork:e=>e.Absent?`<option value="${e._id}">Absent le ${new Date(Number(e.DayDate)).toDateString()}`:`<option value="${e._id}">Present de ${e.StartHour.replace(".","h")} à ${e.EndHour.replace(".","h")} le ${new Date(Number(e.DayDate)).FormatDM()}`,DivFormCardFooterHtmlForm:`
    <div class="w-100 d-inline-flex">
        <div class="rounded-pill w-10"><hr></div>
        <div class="mx-2 my-auto text-nowrap"><p class="m-auto">Select Employee</p></div>
        <div class="w-100 rounded-pill"><hr></div>
    </div>

    <div class="row m-1">
        <div class="col input-group">
            <select class="form-select" aria-label="select employee">
                <option selected="true" disabled>Select Employee</option>
                <option value="new">New Employee</option>
            </select>
        </div>
    </div>

    <div id="OptionAdmin"></div>
    <div id="SubOptionAdmin"></div>
    <div id="NextAdmin"></div>
    `,AdminFormOption:e=>{var t="";return"Manager"===e.permission&&(t="disabled"),`
  <div class="w-100 d-inline-flex">
      <div class="rounded-pill w-10"><hr></div>
      <div class="mx-2 my-auto text-nowrap"><p class="m-auto">Select Option</p></div>
      <div class="w-100 rounded-pill"><hr></div>
  </div>

  <div class="row m-1">
      <div class="col input-group">
          <select class="form-select" aria-label="select option">
              <option  ${"Manager"===e.permission?"":"selected"} disabled>Select Option</option>
              <option value="EditEmp" ${t}>Edit Employee</option>
              <option value="NewWor" ${t}>New Time Work</option>
              <option value="EditWor" ${"Manager"===e.permission?"selected":""}>Edit Time Work</option>
          </select>
      </div>
  </div>`},AdminFormSubOption:`
  <div class="w-100 d-inline-flex">
      <div class="rounded-pill w-10"><hr></div>
      <div class="mx-2 my-auto text-nowrap"><p class="m-auto">Select Time Work</p></div>
      <div class="w-100 rounded-pill"><hr></div>
  </div>

  <div class="row m-1">
      <div class="col input-group">
          <select class="form-select" aria-label="select option">
              <option selected="true" disabled>Select Time Work</option>
          </select>
      </div>
  </div>`,TemplateFormEmployee:e=>{console.log(e);var t="new"===e.type?"New employee":"Edit employee",a="new"===e.type?"disabled":"",i="new"===e.type?"Save Employee":"Edit Employee",l="new"===e.type?"":`value="${e.value.name}"`,n="new"===e.type?"":`value="${e.value.id}"`,o="new"===e.type?"":`value="${e.value.MaxHour}"`;return`
    <div class="w-100 d-inline-flex">
        <div class="rounded-pill w-10"><hr></div>
        <div class="mx-2 my-auto text-nowrap"><p class="m-auto">${t}</p></div>
        <div class="w-100 rounded-pill"><hr></div>
    </div>
    <p class="fst-italic fs-6 fw-light text-danger">Le numéro de pointage doit être unique. (il ne doit pas être renseigné auprès d'un autre employé enregistré)</p>
    <form method="POST" action="/Employe">
        ${"new"===e.type?"":`<input type="text" class="d-none" name="_id" value="${e.value._id}">`}
        <input type="text" class="d-none" name="type" value="${e.type}">
        <input type="text" class="d-none" name="pays" value="${e.account.pays}">
        <input type="number" class="d-none" name="restaurant" value="${e.account.Restaurant}">
        <div class="row m-1">   
            <div class="col input-group">
                <span class="input-group-text">Prénom et Nom</span>
                <input type="text" class="form-control text-uppercase" name="name" placeholder="Prénom et Nom" aria-autocomplete="both" ${l} required>
                <div class="invalid-feedback">
                ${DATA.ErrorValidationForm}
                </div>
            </div>
        </div>

        <div class="row m-1">
            <div class="col input-group">
                <span class="input-group-text">Numéro de pointage</span>
                <input type="number" class="form-control" name="id" placeholder="Numéro de pointage" ${n} required>
                <div class="invalid-feedback">
                    ${DATA.ErrorValidationForm}
                </div>
                <span class="input-group-text">Heure Max</span>
                <input type="number" class="form-control" name="MaxHour" placeholder="Heure max" step="any" ${o} required>
                <div class="invalid-feedback">
                    ${DATA.ErrorValidationForm}
                </div>
            </div>
        </div>

        <div class="row m-1 justify-content-md-center">
            <div class="col-auto btn-group" role="group">
                <button type="button" class="btn btn-outline-danger" ${a}>Delete Employee</button>
                <button type="reset" class="btn btn-outline-secondary">Reset Form</button>
                <button type="submit" class="btn btn-outline-success">${i}</button>
            </div>
        </div>
    </form>
    `},InputRoleEmployee:a=>{console.log(a);var i="",l=!1;return""!==a.Role&&-1!==Object.keys(DATA.Role).indexOf(a.Role)&&(l=!0),Object.keys(DATA.Role).forEach((e,t)=>{l&&e===a.Role?i+=`<option value="${e}" selected>${DATA.Role[Object.keys(DATA.Role)[t]]}</option>`:i+=`<option value="${e}">${DATA.Role[Object.keys(DATA.Role)[t]]}</option>`}),`
    <span class="input-group-text">Role</span>
    <select name="Role" class="form-select">
      <option ${l?"":"selected"} disabled>Sélectionner un rôle</option>
      ${i}
    </select>
    <div class="invalid-feedback">
      ${DATA.ErrorValidationForm}
    </div>
    <span class="input-group-text">Ligne</span>
    <input type="text" class="form-control" name="Line" placeholder="Ligne" value="${""===a.Line?"":a.Line}" ${""===a.Line?"disabled":""}>
    <div class="invalid-feedback">
        ${DATA.ErrorValidationForm}
    </div>
    `},TemplateFormTimeWork:e=>{var t,a,i="new"===e.type?"New time work":"Edit time work",l="new"===e.type?"disabled":"",n="new"===e.type?"Save time work":"Edit time work",o="new"!==e.type&&e.value.Absent?"checked":"",s="new"===e.type?"":`value="${new Date(Number(e.value.DayDate)).FormatYMD()}"`,d="new"===e.type?"":`<input type="text" class="d-none" name="_id" value="${e.value._id}">`,r="Manager"===e.permission?"readonly":"";return"new"!==e.type&&(a=e.value.Absent?t="disabled":(t=`value="${e.value.StartHour.replace(".",":")}"`,`value="${e.value.EndHour.replace(".",":")}"`)),`
    <div class="w-100 d-inline-flex">
        <div class="rounded-pill w-10"><hr></div>
        <div class="mx-2 my-auto text-nowrap"><p class="m-auto">${i}</p></div>
        <div class="w-100 rounded-pill"><hr></div>
    </div>

    <form method="POST" action="/Horaire">
        <input type="text" class="d-none" name="StartWeek" value="${e.StartWeek.getTime()}">
        <input type="text" class="d-none" name="type" value="${e.type}">
        ${d}

        <div class="row m-1">
            <div class="col input-group">
                <span class="input-group-text">Numéro de pointage</span>
                <input type="number" class="form-control" name="id" placeholder="Numéro de pointage" value="${e.id}" readonly>
                <div class="invalid-feedback">
                    ${DATA.ErrorValidationForm}
                </div>

                
                <div class="form-control" ${r}>
                    <input type="checkbox" class="form-check-input" value="" name="Absent" ${o} ${r}>
                    Absent / Week-end
                </div>
                <div class="invalid-feedback">
                    ${DATA.ErrorValidationForm}
                </div>
            </div>
        </div>

        <div class="row m-1">
            <div class="col input-group">
                <span class="input-group-text">Date</span>
                <input type="date" class="form-control" name="DayDate" ${s} required ${r}>
                <div class="invalid-feedback">
                  ${DATA.ErrorValidationForm}
                </div>
                <span class="input-group-text">Horaire</span>
                <input type="time" class="form-control" name="StartHour" ${t} required ${r}>
                <div class="invalid-feedback">
                  ${DATA.ErrorValidationForm}
                </div>
                <span class="input-group-text">-</span>
                <input type="time" class="form-control" name="EndHour" ${a} required ${r}>
                <div class="invalid-feedback">
                  ${DATA.ErrorValidationForm}
                </div>
            </div>
        </div>

        <div class="row m-1">
          <div class="col input-group">
            ${"Manager"===e.permission?HTML.InputRoleEmployee(e.value):""}
          </div>
        </div>
      
        <div class="row m-1 justify-content-md-center">
            <div class="col-auto btn-group" role="group">
            <button type="button" class="btn btn-outline-danger" ${l}>Delete Time Work</button>
            <button type="reset" class="btn btn-outline-secondary">Reset Form</button>
            <button type="submit" class="btn btn-outline-success">${n}</button>
            </div>
        </div>
    </form>
    `},TemplateLineTable:e=>`
        <tr>
            <th name="id" scope="row">${e.id}</th>
            <th name="fullname">${String(e.name).toUpperCase()}</th>
            <td name="monday" class="w-auto"></td>
            <td name="tuesday" class="w-auto"></td>
            <td name="wednesday" class="w-auto"></td>
            <td name="thursday" class="w-auto"></td>
            <td name="friday" class="w-auto"></td>
            <td name="saturday" class="w-auto"></td>
            <td name="sunday" class="w-auto"></td>
            <th name="maxhour"> / ${e.MaxHour}</th>
        </tr>
        `,TemplateLineCard:e=>{var t="";return-1!==Object.keys(e).indexOf("close")?t=`
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-lock-fill" viewBox="0 0 16 16">
        <path d="M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z"/>
      </svg>`:-1!==Object.keys(e).indexOf("open")&&(t=`
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-unlock-fill" viewBox="0 0 16 16">
        <path d="M11 1a2 2 0 0 0-2 2v4a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h5V3a3 3 0 0 1 6 0v4a.5.5 0 0 1-1 0V3a2 2 0 0 0-2-2z"/>
      </svg>`),"danger"===e.type?`
      <div class="my-2 p-1 w-50 text-center align-content-center align-items-center d-flex flex-row justify-content-evenly bagde rounded-pill alert alert-danger shadow container-fluid">
        ${t}
        <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-cpu-fill" viewBox="0 0 16 16">
          <path d="M6.5 6a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3z" />
          <path d="M5.5.5a.5.5 0 0 0-1 0V2A2.5 2.5 0 0 0 2 4.5H.5a.5.5 0 0 0 0 1H2v1H.5a.5.5 0 0 0 0 1H2v1H.5a.5.5 0 0 0 0 1H2v1H.5a.5.5 0 0 0 0 1H2A2.5 2.5 0 0 0 4.5 14v1.5a.5.5 0 0 0 1 0V14h1v1.5a.5.5 0 0 0 1 0V14h1v1.5a.5.5 0 0 0 1 0V14h1v1.5a.5.5 0 0 0 1 0V14a2.5 2.5 0 0 0 2.5-2.5h1.5a.5.5 0 0 0 0-1H14v-1h1.5a.5.5 0 0 0 0-1H14v-1h1.5a.5.5 0 0 0 0-1H14v-1h1.5a.5.5 0 0 0 0-1H14A2.5 2.5 0 0 0 11.5 2V.5a.5.5 0 0 0-1 0V2h-1V.5a.5.5 0 0 0-1 0V2h-1V.5a.5.5 0 0 0-1 0V2h-1V.5zm1 4.5h3A1.5 1.5 0 0 1 11 6.5v3A1.5 1.5 0 0 1 9.5 11h-3A1.5 1.5 0 0 1 5 9.5v-3A1.5 1.5 0 0 1 6.5 5z" />
        </svg>
        <div class="align-middle">${e.time}</div>
      </div>
      `:"moderate"===e.type?`
      <div class="my-2 p-1 w-50 text-center align-content-center align-items-center d-flex flex-row justify-content-evenly bagde rounded-pill alert alert-warning shadow container-fluid">
      ${t}
        <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-person-plus-fill" viewBox="0 0 16 16">
          <path d="M1 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z" />
          <path fill-rule="evenodd" d="M13.5 5a.5.5 0 0 1 .5.5V7h1.5a.5.5 0 0 1 0 1H14v1.5a.5.5 0 0 1-1 0V8h-1.5a.5.5 0 0 1 0-1H13V5.5a.5.5 0 0 1 .5-.5z" />
        </svg>
        <div>${e.time}</div>
      </div>
      `:"chill"===e.type?`
      <div class="my-2 p-1 w-50 text-center align-content-center align-items-center d-flex flex-row justify-content-evenly bagde rounded-pill alert alert-success shadow container-fluid">
        ${t}
        <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-person-dash-fill" viewBox="0 0 16 16">
          <path fill-rule="evenodd" d="M11 7.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1h-4a.5.5 0 0 1-.5-.5z" />
          <path d="M1 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z" />
        </svg>
        <div>${e.time}</div>
      </div>
      `:"neutral"===e.type?`
      <div class="my-2 p-1 w-50 text-center align-content-center align-items-center d-flex flex-row justify-content-evenly bagde rounded-pill alert alert-light shadow container-fluid">
        <div>Abs</div>
      </div>
      `:"pause"===e.type?`
      <div class="my-2 p-1 w-50 text-center align-content-center align-items-center d-flex flex-row justify-content-evenly bagde rounded-pill alert alert-light shadow container-fluid">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pause-fill" viewBox="0 0 16 16">
          <path d="M5.5 3.5A1.5 1.5 0 0 1 7 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5zm5 0A1.5 1.5 0 0 1 12 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5z"/>
        </svg>  
        <div>Pause</div>
      </div>
      `:void 0},OptionEmploye:`
  <button class="btn btn-outline-info border-0" data-bs-toggle="tooltip" tabindex="0" data-bs-placement="bottom" data-bs-html="true" title=""><i class="bi bi-clipboard"></i></button>
  <button class="btn btn-outline-warning border-0" data-bs-toggle="tooltip" tabindex="0" data-bs-placement="bottom" data-bs-html="true" title=""><i class="bi bi-cash-coin"></i></button>
  `,TemplateFormMainPage:e=>{var a="";return e.World.forEach((e,t)=>{a+=`
      <option value="${e.alpha2}">${e.alpha2.toUpperCase()} | ${e.name}</option>`}),`
    <div class="row m-1">
      <div class="col input-group">
        <span class="input-group-text">Pays</span>
        <select name="Pays" class="form-select rounded-end">
          <option selected disabled>Sélectionner un pays</option>
          ${a}
        </select>
        <div class="invalid-feedback">
          test
        </div>
      </div>
    </div>
    <div class="row m-1 d-none">
      <div class="col input-group">
        <span class="input-group-text">Département</span>
        <select name="Departement" class="form-select rounded-end">
          
        </select>
        <div class="invalid-feedback">
          test
        </div>
      </div>
    </div>
    <div class="row m-1 d-none">
      <div class="col input-group">
        <span class="input-group-text">Restaurant</span>
        <select name="Restaurant" class="form-select rounded-end">
        </select>
        <div class="invalid-feedback">
          test
        </div>
      </div>
    </div>
    <div class="d-flex flex-row align-content-between m-auto my-2 d-none">
      <button class="btn btn-outline-warning mx-3">Employee</button>
      <button class="btn btn-outline-secondary mx-3">Manager</button>
      <button class="btn btn-outline-success mx-3">Administration</button>
    </div>
    `},OptionDepartement:t=>{var a="<option selected disabled>Sélectionner votre département</option>";return t.Departement.forEach(e=>{t.pays===e.pays&&(a+=`
        <option value="${e.code}">${e.code} | ${e.name}</option>
        `)}),a},OptionRestaurant:e=>{var a={},i="<option selected disabled>Sélectionner votre restaurant</option>";return e.forEach((e,t)=>{-1===Object.keys(a).indexOf(e.ville)?a[e.ville]=[e]:a[e.ville].push(e)}),Object.keys(a).forEach((e,t)=>{i+=`<optgroup label="${e}">`,a[e].forEach((e,t)=>{i+=`<option value="${e.id}">${e.name}</option>`}),i+="</optgroup>"}),i},AccountPlannings:e=>"view"==e.permission?`
      ${e.username}
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye-fill ms-2" viewBox="0 0 16 16">
          <path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0z"/>
          <path d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8zm8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z"/>
      </svg>
      `:"Administration"==e.permission||"Manager"==e.permission?`
      ${e.username}
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-gear-fill ms-2" viewBox="0 0 16 16">
        <path d="M9.405 1.05c-.413-1.4-2.397-1.4-2.81 0l-.1.34a1.464 1.464 0 0 1-2.105.872l-.31-.17c-1.283-.698-2.686.705-1.987 1.987l.169.311c.446.82.023 1.841-.872 2.105l-.34.1c-1.4.413-1.4 2.397 0 2.81l.34.1a1.464 1.464 0 0 1 .872 2.105l-.17.31c-.698 1.283.705 2.686 1.987 1.987l.311-.169a1.464 1.464 0 0 1 2.105.872l.1.34c.413 1.4 2.397 1.4 2.81 0l.1-.34a1.464 1.464 0 0 1 2.105-.872l.31.17c1.283.698 2.686-.705 1.987-1.987l-.169-.311a1.464 1.464 0 0 1 .872-2.105l.34-.1c1.4-.413 1.4-2.397 0-2.81l-.34-.1a1.464 1.464 0 0 1-.872-2.105l.17-.31c.698-1.283-.705-2.686-1.987-1.987l-.311.169a1.464 1.464 0 0 1-2.105-.872l-.1-.34zM8 10.93a2.929 2.929 0 1 1 0-5.86 2.929 2.929 0 0 1 0 5.858z"/>
      </svg>
      `:void 0,TimeTable:(l,n,o)=>{if(-1!==l.search(";")){var s=l.split(";"),d="";return s.forEach((e,t)=>{var[a,i]=TimeWorkCurrent(o,n[t],l=e);t+1==s.length?d+=`
          <div>
            ${i}
            <p class="Time-${n[t]._id} ${a}">${e}</p>
          </div>`:d+=`
          <div>
            ${i}
            <p class="Time-${n[t]._id} ${a}">${e}</p>
          </div>
          <hr class="dropdown-divider">
          `}),d}var[e,t]=TimeWorkCurrent(o,n,l);return`
      <div class="d-flex">
        ${t}
        <p class="Time-${n._id} ${e}">${l}</p>
      </div>`}};
"/"==window.location.pathname&&(localStorage.clear(),kronos(()=>{kronos().request("POST","/Geo",{type:"get"},n=>{kronos(HREF.DivMainPageForm).html(HTML.TemplateFormMainPage({World:n.Pays}));var o=!1,a=!1;kronos(HREF.SelectMainPage).on("change",e=>{console.log(e,e.target.name),"Pays"===e.target.name&&(kronos(HREF.divSpecificMainPage(2)).class("remove","d-none"),kronos(HREF.divSpecificMainPage(3)).class("add","d-none"),kronos(HREF.divSpecificMainPage(4)).class("add","d-none"),o=!0,kronos(HREF.SelectDepartement).html(HTML.OptionDepartement({pays:e.target.value,Departement:n.Departement}))),"Departement"===e.target.name&&o&&(kronos(HREF.divSpecificMainPage(3)).class("remove","d-none"),a=!0,kronos().request("POST","/Geo",{type:"get",subtype:"Restaurant",pays:kronos(HREF.SelectSpecificMainPage(1)).value(),departement:Number(kronos(HREF.SelectSpecificMainPage(2)).value())},e=>{kronos(HREF.SelectSpecificMainPage(3)).html(HTML.OptionRestaurant(e.Restaurant))})),"Restaurant"===e.target.name&&o&&a&&(kronos(HREF.MainPageDivBtn).class("remove","d-none"),0)}),kronos(HREF.MainPageBtn).on("click",e=>{var e=e.target.innerHTML,n="";"Employee"===e&&(localStorage.setItem("account",JSON.stringify({username:"viewer",permission:"view",pays:kronos(HREF.SelectSpecificMainPage(1)).value(),Restaurant:kronos(HREF.SelectSpecificMainPage(3)).value()})),window.location.href="/plannings"),"Manager"===e&&(kronos(HREF.DivConnectionLandingPage).class("remove","d-none"),n="Manager"),"Administration"===e&&(kronos(HREF.DivConnectionLandingPage).class("remove","d-none"),n="Administration"),kronos(HREF.BtnConnectionLandingPage).on("click",e=>{console.log(e,String(kronos(HREF.IptUsername).value()),String(kronos(HREF.IptPassword).value())),kronos().request("POST","/Connection",{username:String(kronos(HREF.IptUsername).value()),password:String(kronos(HREF.IptPassword).value()),permission:n},e=>{e=e[0],console.log(e),"Error Connection"===e[0]?(kronos(HREF.IptUsername).value(""),kronos(HREF.IptPassword).value(""),new bootstrap.Toast(document.getElementById("liveToast")).show()):(localStorage.setItem("account",JSON.stringify({username:e.username,permission:e.permission,pays:kronos(HREF.SelectSpecificMainPage(1)).value(),Restaurant:kronos(HREF.SelectSpecificMainPage(3)).value()})),window.location.href="/plannings")})}),kronos().keypress(e=>{"Enter"===e.key&&kronos(HREF.IptUsername).value()&&kronos(HREF.IptPassword).value()&&SimulateEvent(kronos(HREF.BtnConnectionLandingPage)[0],"click")})})})}));
"/plannings"==window.location.pathname&&(null==localStorage.getItem("account")&&(window.location.pathname="/"),kronos(()=>{let a=[getRangeWeek()];a[0][0];a.push(getRangeWeek(new Date(new Date(a[0][1]).setDate(a[0][1].getDate()+1))),getRangeWeek(new Date(new Date(a[0][1]).setDate(a[0][1].getDate()+8)))),a.forEach((e,t)=>{kronos(HREF.SelectTimeWeekOption(t)).html(`Semaine du ${e[0].FormatDM()} au ${e[1].FormatDM()}`)}),localStorage.removeItem("employee");let s={},c={},u={},m=null,o={},r={current:{},day:{}};function n(e=0){var t=a[e][0],o=a[e][1];localStorage.setItem("currentWeek",a[e][2]),kronos(HREF.TitleTableCard).html(`Semaine du ${FormatCompactDate(t)}/${9<t.getMonth()?o.getMonth()+1:"0"+(o.getMonth()+1)} au ${FormatCompactDate(o)}/${9<o.getMonth()?o.getMonth()+1:"0"+(o.getMonth()+1)}`)}var l;localStorage.getItem("currentWeek")?(l=!1,a.forEach((e,t)=>{0!==t&&e[2]===Number(localStorage.getItem("currentWeek"))&&(kronos(HREF.SelectTimeWeekAllOption).attr("remove","selected"),kronos(HREF.SelectTimeWeekOption(t)).attr("add","selected"),n(t),l=!0)}),l||n()):n(),m=Number(localStorage.getItem("currentWeek"))===a[0][2],kronos(HREF.SelectTimeWeek).on("change",e=>{n(Number(e.target.value)),document.location.reload()}),kronos(HREF.ListUniqueWorkerButton).forEach(e=>e.addEventListener("click",e=>{(void 0!==e.target.ownerSVGElement&&null!=e.target.ownerSVGElement?e.target.ownerSVGElement:"svg"===e.target.tagName?e.target:"DIV"===e.target.tagName?e.target.nextElementSibling:e.target.children[1]).classList.toggle(HREF.AnimationArrow)})),"Administration"===JSON.parse(localStorage.getItem("account")).permission||"Manager"===JSON.parse(localStorage.getItem("account")).permission?(kronos(HREF.DivFormCardFooter).html(HTML.DivFormCardFooterHtmlForm),kronos(HREF.DivConnectPlannings).html(HTML.AccountPlannings(JSON.parse(localStorage.getItem("account"))))):"viewer"===JSON.parse(localStorage.getItem("account")).permission?kronos(HREF.DivConnectPlannings).html(HTML.AccountPlannings(JSON.parse(localStorage.getItem("account")))):kronos(HREF.DivFormCardFooter).remove(),DATA.DayWeekDate.forEach((e,t)=>{var o=(new Date).getDay();m&&(0===o?e===DATA.DayWeekDate[o]?kronos(HREF.SpecificDropDownCard(e)).class("add","text-warning"):kronos(HREF.SpecificDropDownCard(e)).class("add","text-success"):e===DATA.DayWeekDate[o]?kronos(HREF.SpecificDropDownCard(e)).class("add","text-warning"):(t<o?kronos(HREF.SpecificDropDownCard(e)).class("add","text-success"):kronos(HREF.SpecificDropDownCard(e)).class("add","text-danger"),kronos(HREF.SpecificDropDownCard(DATA.DayWeekDate[0])).class("add","text-danger")))}),"Administration"!==JSON.parse(localStorage.getItem("account")).permission&&"Manager"!==JSON.parse(localStorage.getItem("account")).permission||kronos().request("POST","/Employe",{type:"get",pays:JSON.parse(localStorage.getItem("account")).pays,restaurant:Number(JSON.parse(localStorage.getItem("account")).Restaurant)},e=>{e.forEach(e=>{kronos(HREF.InputSelectEmployee).append(HTML.SelectOptionEmployee(e))}),kronos(HREF.InputSelectEmployee).on("change",e=>{kronos(HREF.DivNextAdminForm).html(""),kronos(HREF.DivAdminSubOption).html(""),console.log(e.target.value,"Select Employee"!==e.target.value),"new"!==e.target.value&&"Select Employee"!==e.target.value?kronos().request("POST","/Employe",{type:"getOne",_id:e.target.value},t=>{localStorage.setItem("employee",JSON.stringify(t[0])),kronos(HREF.DivAdminOption).html(HTML.AdminFormOption(JSON.parse(localStorage.getItem("account")))),kronos(HREF.InputSelectOption).on("change",e=>{kronos(HREF.DivNextAdminForm).html(""),console.log(e.target.value,t),"EditEmp"===e.target.value&&(kronos(HREF.DivAdminSubOption).html(""),kronos(HREF.DivNextAdminForm).html(HTML.TemplateFormEmployee({type:"edit",id:Number(JSON.parse(localStorage.getItem("employee")).id),value:JSON.parse(localStorage.getItem("employee")),account:JSON.parse(localStorage.getItem("account"))})),kronos(HREF.ButtonDeleteForm).on("click",e=>{kronos().request("POST","/Employe",{type:"remove",_id:JSON.parse(localStorage.getItem("employee"))._id,id:JSON.parse(localStorage.getItem("employee")).id},e=>{}),window.location.reload()})),"NewWor"===e.target.value&&(kronos(HREF.DivAdminSubOption).html(""),kronos(HREF.DivNextAdminForm).html(HTML.TemplateFormTimeWork({type:"new",id:JSON.parse(localStorage.getItem("employee")).id,StartWeek:new Date(Number(localStorage.getItem("currentWeek")))})),kronos("div#NextAdmin > form > input:nth-child(2)").on("change",e=>{e.target.value="new"}),kronos(HREF.InputFormCheckAbsent).on("change",e=>{kronos(HREF.InputFormTimeStart).attr("toggle","disabled"),kronos(HREF.InputFormTimeEnd).attr("toggle","disabled")}),kronos(HREF.InputFormDate).on("change",e=>{kronos(HREF.InputFormStartWeek).value(String(getRangeWeek(new Date(e.target.value))[0].setHours(0)))})),"EditWor"===e.target.value&&(kronos(HREF.DivAdminSubOption).html(HTML.AdminFormSubOption),kronos().request("POST","/Horaire",{type:"get",subtype:"employe",week:Number(localStorage.getItem("currentWeek")),id:JSON.parse(localStorage.getItem("employee")).id},e=>{e.forEach(e=>{kronos(HREF.InputSelectSubOption).append(HTML.SelectOptionTimeWork(e))}),kronos(HREF.InputSelectSubOption).on("change",e=>{kronos().request("POST","/Horaire",{type:"getOne",_id:e.target.value},t=>{var e="",e="Manager"===JSON.parse(localStorage.getItem("account")).permission?"Manager":"Administration";kronos(HREF.DivNextAdminForm).html(HTML.TemplateFormTimeWork({type:"edit",id:JSON.parse(localStorage.getItem("employee")).id,value:t,StartWeek:new Date(Number(localStorage.getItem("currentWeek"))),permission:e})),kronos(HREF.InputFormDate).on("change",e=>{kronos(HREF.InputFormStartWeek).value(String(getRangeWeek(new Date(e.target.value))[0].setHours(0)))}),kronos(HREF.InputSelectRole).on("change",e=>{console.log(e),"K"===e.target.value[0]&&"C"!==e.target.value[1]?kronos(HREF.InputLineWork).attr("remove","disabled"):kronos(HREF.InputLineWork).attr("add","disabled","true")}),kronos(HREF.InputFormCheckAbsent).on("change",e=>{kronos(HREF.InputFormTimeStart).attr("toggle","disabled"),kronos(HREF.InputFormTimeEnd).attr("toggle","disabled")}),kronos(HREF.ButtonDeleteForm).on("click",e=>{kronos().request("POST","/Horaire",{type:"remove",_id:t._id},e=>{}),window.location.reload()})})})}))})}):"new"===e.target.value&&(localStorage.removeItem("employee"),kronos(HREF.DivAdminOption).html(""),kronos(HREF.DivNextAdminForm).html(HTML.TemplateFormEmployee({type:"new",account:JSON.parse(localStorage.getItem("account"))})))})}),kronos().request("POST","/Employe",{type:"get",pays:JSON.parse(localStorage.getItem("account")).pays,restaurant:Number(JSON.parse(localStorage.getItem("account")).Restaurant)},e=>{e.forEach((e,t)=>{kronos(HREF.BodyTable).append(HTML.TemplateLineTable(e)),s[e.id]=t,o[e.name]=e.id,c[e.id]={},u[e.id]=e._id}),kronos().request("POST","/Horaire",{type:"get",week:Number(localStorage.getItem("currentWeek")),Employe:Object.keys(c)},(e,t)=>{e.forEach((e,t)=>{var[,,o,a]=TimeWorkCurrent(m,e,null,!0);o&&(-1!==Object.keys(r.day).indexOf(e.EmployePlanning)?r.day[e.EmployePlanning].push(e):r.day[e.EmployePlanning]=[e]),a&&(-1!==Object.keys(r.day).indexOf(e.EmployePlanning)?r.current[e.EmployePlanning].push(e):r.current[e.EmployePlanning]=[e]),-1!==Object.keys(c[e.EmployePlanning]).indexOf(e.DayDate)?c[e.EmployePlanning][e.DayDate].push(e):c[e.EmployePlanning][e.DayDate]=[e]}),Object.keys(c).forEach((n,e)=>{var l,i,t;0!==Object.keys(c[n]).length&&(i=l=0,Object.keys(c[n]).forEach((o,e)=>{var a,r;c[n][o].forEach((e,t)=>{e.Absent?i++:l+=Number(TimeBetweenTwoTime(e.StartHour.replace(".",":"),e.EndHour.replace(".",":")))}),1===c[n][o].length?c[n][o][0].Absent?kronos(HREF.TableSpecificLine({row:s[n]+2,column:DATA.DayWeekDataTable[new Date(Number(o)).getDay()]})).html("<p>Abs</p>"):kronos(HREF.TableSpecificLine({row:s[n]+2,column:DATA.DayWeekDataTable[new Date(Number(o)).getDay()]})).append(HTML.TimeTable(c[n][o][0].StartHour.replace(".",":")+" - "+c[n][o][0].EndHour.replace(".",":"),c[n][o][0],m)):(a="",r=[],c[n][o].forEach((e,t)=>{c[n][o][0].Absent?kronos(HREF.TableSpecificLine({row:s[n]+2,column:DATA.DayWeekDataTable[new Date(Number(o)).getDay()]})).html("<p>Abs</p>"):(""!==a?a+=`;${c[n][o][t].StartHour.replace(".",":")} - ${c[n][o][t].EndHour.replace(".",":")}`:a=`${c[n][o][t].StartHour.replace(".",":")} - ${c[n][o][t].EndHour.replace(".",":")}`,r.push(c[n][o][t]))}),""!==a&&kronos(HREF.TableSpecificLine({row:s[n]+2,column:DATA.DayWeekDataTable[new Date(Number(o)).getDay()]})).html(HTML.TimeTable(a,r,m)))}),t=Number(kronos(HREF.SpecificColumnTable(10))[s[n]+2].innerHTML.replace(" / ","")),(l=7==i?"Abs":l)==t?kronos(HREF.SpecificColumnTable(10))[s[n]+2].classList.add("text-warning"):l<t?kronos(HREF.SpecificColumnTable(10))[s[n]+2].classList.add("text-success"):"Abs"!=l&&kronos(HREF.SpecificColumnTable(10))[s[n]+2].classList.add("text-danger"),kronos(HREF.SpecificColumnTable(10))[s[n]+2].innerHTML=`${l} ${kronos(HREF.SpecificColumnTable(10))[s[n]+2].innerHTML}`)}),kronos(HREF.PTotalEmpWork).html(`${kronos(HREF.AllPTextWarning).length} employée sur ${Object.keys(c).length} actif(s)`);var o=[];kronos(HREF.AllPTextWarning).forEach((e,t)=>{e=e.parentElement.parentElement.parentElement.children[1].innerHTML,-1==o.indexOf(e)&&o.push(e)}),kronos(HREF.PTotalEmpWork).attr("add","title",o.join(", ")),ReloadTooltips(),kronos(HREF.RowTableCard).forEach(e=>{e.addEventListener("click",e=>{kronos("."+HREF.AnimationArrow).class("remove",HREF.AnimationArrow),kronos(HREF.BtnOptionEmploye).attr("remove","disabled"),kronos(HREF.DivOptionEmploye).html("");var t="",o="",a="",r="",n="",l="",i="",s="",c="",m="";"TD"==e.target.tagName||"TH"==e.target.tagName?{FullName:t,id:o,HourMonday:a,HourTuesday:r,HourWednesday:n,HourThursday:l,HourFriday:i,HourSaturday:s,HourSunday:c,TotalHour:m}=GetDataTable(t,o,a,r,n,l,i,s,c,m,e.path[1]):"P"==e.target.tagName||"HR"==e.target.tagName||"I"==e.target.tagName?{FullName:t,id:o,HourMonday:a,HourTuesday:r,HourWednesday:n,HourThursday:l,HourFriday:i,HourSaturday:s,HourSunday:c,TotalHour:m}=GetDataTable(t,o,a,r,n,l,i,s,c,m,e.path[3]):"TR"==e.target.tagName?{FullName:t,id:o,HourMonday:a,HourTuesday:r,HourWednesday:n,HourThursday:l,HourFriday:i,HourSaturday:s,HourSunday:c,TotalHour:m}=GetDataTable(t,o,a,r,n,l,i,s,c,m,e.target):"DIV"==e.target.tagName&&({FullName:t,id:o,HourMonday:a,HourTuesday:r,HourWednesday:n,HourThursday:l,HourFriday:i,HourSaturday:s,HourSunday:c,TotalHour:m}=GetDataTable(t,o,a,r,n,l,i,s,c,m,e.path[2])),kronos().request("POST","/Employe",{type:"getOne",_id:u[Number(o)]},e=>{(e=e[0]).TotalHour=m,localStorage.setItem("employee",JSON.stringify(e))}),"Administration"===JSON.parse(localStorage.getItem("account")).permission?ClickRowTableAdmin(u,o,e):"Manager"!==JSON.parse(localStorage.getItem("account")).permission||e.target.classList.contains("text-success")||e.path[2].cellIndex+1!==DATA.DayWeekDataTable[(new Date).getDay()]?"Manager"===JSON.parse(localStorage.getItem("account")).permission&&ClickRowTableManager(u,o,e,!0):ClickRowTableManager(u,o,e);s=[c,a,r,n,l,i,s];kronos(HREF.ListUniqueWorkerHeader).html(`${o} | ${t}`),s.forEach((o,a)=>{kronos(HREF.CardSpecificDay(DATA.DayWeekDate[a])).html(""),""!=o&&"Abs"!=o?(-1!==o.indexOf(";")?o.split(";").forEach((e,t)=>{SpecificDay(e,a,t,o)}):SpecificDay(o,a),SimulateEvent(kronos(HREF.CardSpecificDay(DATA.DayWeekDate[a]))[0].previousElementSibling,"click")):"Abs"===o?(kronos(HREF.CardSpecificDay(DATA.DayWeekDate[a])).html(HTML.TemplateLineCard({type:"neutral"})),SimulateEvent(kronos(HREF.CardSpecificDay(DATA.DayWeekDate[a]))[0].previousElementSibling,"click")):kronos(HREF.CardSpecificDay(DATA.DayWeekDate[a])).html("")})})})})}),kronos(HREF.BtnOptionEmploye).on("click",e=>{kronos(HREF.DivOptionEmploye).html(HTML.OptionEmploye);var t,o=JSON.parse(localStorage.getItem("employee")),a="";-1!==Object.keys(r.current).indexOf(`${o.id}`)&&(a="K"===(t=r.current[`${o.id}`][0].Role)[0]&&"C"!==t[1]?`Poste ${DATA.Role[t]} ligne ${r.current[`${o.id}`][0].Line}`:`Poste ${DATA.Role[t]}`),console.log(Object.keys(r.current),`${o.id}`,a,Object.keys(r.current).indexOf(`${o.id}`)),"Abs"==o.TotalHour&&(o.TotalHour=Number(o.MaxHour)-1),kronos(HREF.BtnSalaireEmploye).attr("add","title",`≈ ${String((10.15*o.TotalHour).round()).replace(".",",")} €<br/><em>Base de 10.15 €/Heure<br/>Pas de Majoration</em>`),kronos(HREF.BtnRoleEmploye).attr("add","title",a),""==a?kronos(HREF.BtnRoleEmploye).attr("add","disabled","true"):kronos(HREF.BtnRoleEmploye).attr("remove","disabled","true"),ReloadTooltips()});var t=!1;kronos(HREF.InputSearchBar).on("click",e=>{t=!0}),document.addEventListener("keypress",e=>{"Enter"===e.key&&t&&Search(s,o)}),kronos(HREF.BtnSearchBar).on("click",e=>{t&&Search(s,o)})}));
function ClickRowTableAdmin(e,t,o){kronos(HREF.InputSelectEmployeeOption).attr("remove","selected"),kronos(HREF.SelectSpecificEmployee(e[t])).attr("add","selected","true"),SimulateEvent(kronos(HREF.InputSelectEmployee)[0]),"TD"==o.target.tagName?setTimeout(()=>{kronos(HREF.InputSelectOptionOption).attr("remove","selected"),kronos(HREF.SelectSpecificOption("NewWor")).attr("add","selected","true"),SimulateEvent(kronos(HREF.InputSelectOption)[0]),kronos(HREF.InputSelectOption)[0].scrollIntoView(!0),setTimeout(()=>{kronos(HREF.InputFormDate).value(`${new Date(new Date(Number(localStorage.getItem("currentWeek"))).setDate(new Date(Number(localStorage.getItem("currentWeek"))).getDate()+(Number(o.target.cellIndex)-2))).FormatYMD()}`)},100)},100):"DIV"==o.target.tagName?setTimeout(()=>{kronos(HREF.InputSelectOptionOption).attr("remove","selected"),kronos(HREF.SelectSpecificOption("NewWor")).attr("add","selected","true"),SimulateEvent(kronos(HREF.InputSelectOption)[0]),kronos(HREF.InputSelectOption)[0].scrollIntoView(!0),setTimeout(()=>{kronos(HREF.InputFormDate).value(`${new Date(new Date(Number(localStorage.getItem("currentWeek"))).setDate(new Date(Number(localStorage.getItem("currentWeek"))).getDate()+(Number(o.path[1].cellIndex)-2))).FormatYMD()}`)},100)},100):"P"!=o.target.tagName?setTimeout(()=>{kronos(HREF.InputSelectOptionOption).attr("remove","selected"),kronos(HREF.SelectSpecificOption("EditEmp")).attr("add","selected","true"),SimulateEvent(kronos(HREF.InputSelectOption)[0]),kronos(HREF.InputSelectOption)[0].scrollIntoView(!0)},100):setTimeout(()=>{kronos(HREF.InputSelectOptionOption).attr("remove","selected"),kronos(HREF.SelectSpecificOption("EditWor")).attr("add","selected","true"),SimulateEvent(kronos(HREF.InputSelectOption)[0]),setTimeout(()=>{kronos(HREF.InputSelectSubOptionOption).attr("remove","selected"),kronos(HREF.SelectSpecificSubOption(o.target.classList[0].replaceAll("Time-",""))).attr("add","selected","true"),SimulateEvent(kronos(HREF.InputSelectSubOption)[0]),kronos(HREF.InputSelectSubOption)[0].scrollIntoView(!0)},100)},100)}
function ClickRowTableManager(e,t,o,n=!1){kronos(HREF.InputSelectEmployeeOption).attr("remove","selected"),(n?kronos(HREF.SelectSpecificOptionEmploye(1)):kronos(HREF.SelectSpecificEmployee(e[t]))).attr("add","selected","true"),SimulateEvent(kronos(HREF.InputSelectEmployee)[0]),n?kronos(HREF.DivAdminOption).html(""):setTimeout(()=>{kronos(HREF.InputSelectOptionOption).attr("remove","selected"),kronos(HREF.SelectSpecificOption("EditWor")).attr("add","selected","true"),SimulateEvent(kronos(HREF.InputSelectOption)[0]),setTimeout(()=>{kronos(HREF.InputSelectSubOptionOption).attr("remove","selected"),kronos(HREF.SelectSpecificSubOption(o.target.classList[0].replaceAll("Time-",""))).attr("add","selected","true"),SimulateEvent(kronos(HREF.InputSelectSubOption)[0]),kronos(HREF.InputSelectSubOption)[0].scrollIntoView(!0)},100)},100)}